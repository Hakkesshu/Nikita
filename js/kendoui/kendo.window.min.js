/*
* Kendo UI Complete v2012.1.423 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at http://kendoui.com/complete-license
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(a,b){function P(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:n,group:a.wrapper.id+"-moving",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b),dragcancel:g(b.dragcancel,b)})}function O(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:p,group:a.wrapper.id+"-resizing",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b)})}function N(b,c){var d=b,e,f;c.scrollable===!1&&d.attr("style","overflow:hidden;"),c.iframe&&d.html(l.contentFrame(c)),f=a(l.wrapper(c)),c.title!==!1&&f.append(l.titlebar(h(l,c))),f.toggleClass("k-rtl",!!b.closest(".k-rtl").length),e=d.find("iframe").map(function(a){var b=this.getAttribute("src");this.src="";return b}),f.appendTo(k).append(d).find("iframe").each(function(a){this.src=e[a]})}function L(a,b){return function(){var a=this,c=a.wrapper,d=c[0].style,e=a.options;if(!e.isMaximized&&!e.isMinimized){a.restoreOptions={width:d.width,height:d.height},c.find(p).hide().end().find(H).parent().hide().eq(0).before(l.action({name:"Restore"})),b.call(a);return a}}}function K(){return a(m).filter(function(){var b=a(this);return b.is(u)&&J(b).options.modal}).sort(function(b,c){return+a(b).css("zIndex")- +a(c).css("zIndex")})}function J(a){return a.children(o).data("kendoWindow")}var c=window.kendo,d=c.ui.Widget,e=c.ui.Draggable,f=a.isPlainObject,g=a.proxy,h=a.extend,i=a.each,j=c.template,k,l,m=".k-window",n=".k-window-titlebar",o=".k-window-content",p=".k-resize-handle",q=".k-overlay",r="k-content-frame",s="k-loading",t="k-state-hover",u=":visible",v="cursor",w="open",x="activate",y="deactivate",z="close",A="refresh",B="resize",C="dragstart",D="dragend",E="error",F="overflow",G="zIndex",H=".k-window-actions .k-minimize,.k-window-actions .k-maximize",I=c.isLocalUrl,M=d.extend({init:function(b,e){var h=this,j,o,p,q,r=!1,s;k=document.body,d.fn.init.call(h,b,e),e=h.options,b=h.element,s=e.content,h._animations(),f(s)||(s=e.content={url:s}),b.parent().is("body")||(b.is(u)?(o=b.offset(),r=!0):(p=b.css("visibility"),q=b.css("display"),b.css({visibility:"hidden",display:""}),o=b.offset(),b.css({visibility:p,display:q}))),j=h.wrapper=b.closest(m);if(!b.is(".k-content")||!j[0])b.addClass("k-window-content k-content"),N(b,e),j=h.wrapper=b.closest(m),h._dimensions();o&&(r?j.css({top:o.top,left:o.left}):j.css({top:o.top,left:o.left,visibility:"visible",display:"none"})),s&&h.refresh(s),h.toFront(),e.modal&&h._overlay(j.is(u)).css({opacity:.5}),j.on({mouseenter:function(){a(this).addClass(t)},mouseleave:function(){a(this).removeClass(t)},click:g(h._windowActionHandler,h)},".k-window-titlebar .k-window-action"),e.resizable&&(j.on("dblclick",n,g(h.toggleMaximization,h)),i("n e s w se sw ne nw".split(" "),function(a,b){j.append(l.resizeHandle(b))}),h.resizing=new O(h)),e.draggable&&(h.dragging=new P(h)),j.add(j.find(".k-resize-handle,.k-window-titlebar")).on("mousedown",g(h.toFront,h)),h.touchScroller=c.touchScroller(b),a(window).resize(g(h._onDocumentResize,h)),j.is(u)&&(h.trigger(w),h.trigger(x)),c.notify(h)},_dimensions:function(){var a=this,b=a.wrapper,c=a.element,d=a.options;a.title(d.title),d.width&&b.width(d.width),d.height&&b.height(d.height),i(["minWidth","minHeight","maxWidth","maxHeight"],function(a,b){var e=d[b];e&&e!=Infinity&&c.css(b,e)}),d.visible||b.hide()},_animations:function(){var a=this.options;a.animation===!1&&(a.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(a){d.fn.setOptions.call(this,a),this._animations(),this._dimensions()},events:[w,x,y,z,A,B,C,D,E],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350,show:!0},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:Infinity,maxHeight:Infinity,visible:!0},_overlay:function(b){var c=a("body > .k-overlay"),d=this.wrapper;c.length||(c=a("<div class='k-overlay' />")),c.insertBefore(d[0]).toggle(b).css(G,parseInt(d.css(G),10)-1);return c},_windowActionHandler:function(b){var c=a(b.target).closest(".k-window-action").find(".k-icon"),d=this;i({"k-close":d.close,"k-maximize":d.maximize,"k-minimize":d.minimize,"k-restore":d.restore,"k-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var b=this.wrapper,c=a(window);b.css({left:c.scrollLeft()+Math.max(0,(c.width()-b.width())/2),top:c.scrollTop()+Math.max(0,(c.height()-b.height())/2)});return this},title:function(a){var b=this,c=b.wrapper,d=b.options,e=c.find(n),f=e.children(".k-window-title"),g=e.outerHeight();if(!arguments.length)return f.text();a===!1?(c.addClass("k-window-titleless"),e.remove()):(e.length||c.prepend(l.titlebar(h(l,d))),c.css("padding-top",g),e.css("margin-top",-g)),f.text(a);return b},content:function(a){var b=this.wrapper.children(o);if(!a)return b.html();b.html(a);return this},open:function(){var b=this,c=b.wrapper,d=b.options.animation.open,e=c.children(o),f=e.css(F);if(!b.trigger(w)){b.toFront();if(b.options.modal){var g=b._overlay(!1);d.duration?g.kendoStop().kendoAnimate({effects:{fade:{direction:"out",properties:{opacity:.5}}},duration:d.duration,show:!0}):g.css("opacity",.5).show()}c.is(u)||(e.css(F,"hidden"),c.show().kendoStop().kendoAnimate({effects:d.effects,duration:d.duration,complete:function(){b.trigger(x),e.css(F,f)}}))}b.options.isMaximized&&a("html, body").css(F,"hidden");return b},close:function(){var c=this,d=c.wrapper,e=c.options,f=e.animation.open,g=e.animation.close,h,i,j;d.is(u)&&!c.trigger(z)&&(h=K(),i=e.modal&&h.length==1,j=e.modal?c._overlay(!0):a(b),i?g.duration?j.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:0}}},duration:g.duration,hide:!0}):j.hide():h.length&&J(h.eq(h.length-2))._overlay(!0),d.kendoStop().kendoAnimate({effects:g.effects||f.effects,reverse:g.reverse===!0,duration:g.duration,complete:function(){d.hide(),c.trigger(y)}})),c.options.isMaximized&&a("html, body").css(F,"");return c},toFront:function(){var b=this,c=b.wrapper,d=c[0],e=+c.css(G),f=e;a(m).each(function(b,c){var f=a(c),g=f.css(G),h=f.find(o);isNaN(g)||(e=Math.max(+g,e)),c!=d&&h.find("> ."+r).length>0&&h.append(l.overlay)});if(e==10001||f<e)c.css(G,e+2),b.element.find("> .k-overlay").remove();return b},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this,c=b.options,d=b.restoreOptions;if(!!c.isMaximized||!!c.isMinimized){b.wrapper.css({position:"absolute",left:d.left,top:d.top,width:d.width,height:d.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-restore").parent().remove().end().end().find(H).parent().show(),a("html, body").css(F,""),c.isMaximized=c.isMinimized=!1,b.trigger(B);return b}},maximize:L("maximize",function(){var b=this,c=b.wrapper,d=c.position();h(b.restoreOptions,{left:d.left,top:d.top}),c.css({left:0,top:0,position:"fixed"}),a("html, body").css(F,"hidden"),b.options.isMaximized=!0,b._onDocumentResize()}),minimize:L("minimize",function(){var a=this;a.wrapper.css("height",""),a.element.hide(),a.options.isMinimized=!0}),_onDocumentResize:function(){var b=this,c=b.wrapper,d=a(window);!b.options.isMaximized||(c.css({width:d.width(),height:d.height()}),b.trigger(B))},refresh:function(b){var c=this,d=c.options,e=a(c.element),g,i;f(b)||(b={url:b}),b=h({},d.content,b),i=b.url,i?c.options.iframe===!1||I(i)?c._ajaxRequest(b):(g=e.find("."+r)[0],g?g.src=i||g.src:e.html(l.contentFrame(h({},d,{content:b})))):b.template&&c.content(j(b.template)({}));return c},_ajaxRequest:function(b){var c=this,d=b.template,e=c.wrapper.find(".k-window-titlebar .k-refresh"),f=setTimeout(function(){e.addClass(s)},100);a.ajax(h({type:"GET",dataType:"html",cache:!1,error:g(function(a,b){c.trigger(E)},c),complete:function(){clearTimeout(f),e.removeClass(s)},success:g(function(a,b){d&&(a=j(d)(a||{})),c.element.html(a),c.trigger(A)},c)},b))},destroy:function(){var a=this,b,c;a.wrapper.remove(),b=K(),c=a.options.modal&&!b.length,c?a._overlay(!1).remove():b.length>0&&J(b.eq(b.length-2))._overlay(!0)}});l={wrapper:j("<div class='k-widget k-window' />"),action:j("<a href='\\#' class='k-window-action k-link'><span class='k-icon k-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:j("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions k-header'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:j("<iframe src='#= content.url #' title='#= title #' frameborder='0' class='"+r+"'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:j("<div class='k-resize-handle k-resize-#= data #'></div>")},O.prototype={dragstart:function(b){var c=this.owner,d=c.wrapper;c.elementPadding=parseInt(c.wrapper.css("padding-top"),10),c.initialCursorPosition=d.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("k-resize-handle k-resize-","").split(""),c.initialSize={width:c.wrapper.width(),height:c.wrapper.height()},d.append(l.overlay).find(p).not(b.currentTarget).hide(),a(k).css(v,b.currentTarget.css(v))},drag:function(a){var b=this.owner,c=b.wrapper,d=b.options,e=function(a,b,c){return Math.max(Math.min(a,c),b)},f={e:function(){var f=a.x.location-b.initialCursorPosition.left;c.width(e(f,d.minWidth,d.maxWidth))},s:function(){var f=a.y.location-b.initialCursorPosition.top-b.elementPadding;c.height(e(f,d.minHeight,d.maxHeight))},w:function(){var f=b.initialCursorPosition.left+b.initialSize.width,g=e(f-a.x.location,d.minWidth,d.maxWidth);c.css({left:f-g,width:g})},n:function(){var f=b.initialCursorPosition.top+b.initialSize.height,g=e(f-a.y.location,d.minHeight,d.maxHeight);c.css({top:f-g,height:g})}};i(b.resizeDirection,function(){f[this]()}),b.trigger(B)},dragend:function(b){var c=this.owner,d=c.wrapper;d.find(q).remove().end().find(p).not(b.currentTarget).show(),a(k).css(v,""),c.touchScroller&&c.touchScroller.reset(),b.keyCode==27&&d.css(c.initialCursorPosition).css(c.initialSize);return!1}},P.prototype={dragstart:function(b){var c=this.owner,d=c.element,e=d.find(".k-window-actions");c.trigger(C),c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.x.client-c.initialWindowPosition.left,top:b.y.client-c.initialWindowPosition.top},e.length>0?c.minLeftPosition=e.outerWidth()+parseInt(e.css("right"),10)-d.outerWidth():c.minLeftPosition=20-d.outerWidth(),c.wrapper.append(l.overlay).find(p).hide(),a(k).css(v,b.currentTarget.css(v))},drag:function(b){var c=this.owner,d={left:Math.max(b.x.client-c.startPosition.left,c.minLeftPosition),top:Math.max(b.y.client-c.startPosition.top,0)};a(c.wrapper).css(d)},dragcancel:function(b){var c=this.owner;c.wrapper.find(p).show().end().find(q).remove(),a(k).css(v,""),b.currentTarget.closest(m).css(c.initialWindowPosition)},dragend:function(b){var c=this.owner;c.wrapper.find(p).show().end().find(q).remove(),a(k).css(v,""),c.trigger(D);return!1}},c.ui.plugin(M)})(jQuery)